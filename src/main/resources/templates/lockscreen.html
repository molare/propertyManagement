<!DOCTYPE html>
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width initial-scale=1.0">
    <title>APPS_IMMOBILIERE</title>
    <!-- GLOBAL MAINLY STYLES-->
    <link href="/html/dist/assets/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/html/dist/assets/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <!-- THEME STYLES-->
    <link href="/html/dist/assets/css/main.css" rel="stylesheet" />

    <!-- CORE PLUGINS -->
    <script src="/html/dist/assets/vendors/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="/html/dist/assets/vendors/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>

    <script src="/html/dist/assets/vendors/popper.js/dist/umd/popper.min.js" type="text/javascript"></script>
    <script src="/html/dist/assets/vendors/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <!-- PAGE LEVEL PLUGINS -->
    <script src="/html/dist/assets/vendors/jquery-validation/dist/jquery.validate.min.js" type="text/javascript"></script>
    <!-- CORE SCRIPTS-->
    <script src="/html/dist/assets/js/app.js" type="text/javascript"></script>
    <!-- PAGE LEVEL SCRIPTS-->
    <script type="text/javascript">
        $(function() {
            $('#sign_in').validate({
                errorClass: "help-block",
                rules: {
                    username: {
                        required: true,
                    },
                    password: {
                        required: true
                    }
                },
                highlight: function(e) {
                    $(e).closest(".form-group").addClass("has-error")
                },
                unhighlight: function(e) {
                    $(e).closest(".form-group").removeClass("has-error")
                },
                errorPlacement: function(e, r) {
                    var i = $(r).parents(".input-group, .check-list");
                    i.length ? i.after(e) : r.after(e)
                },
            });
        });

        $(document).ready(function() {
            localStorage.removeItem("token");

            $("#btnLoginId").on('click', function (e) {
                e.preventDefault();

                var formdata = $("#sign_inForm").serializeArray();
                var data = {};
                $(formdata).each(function(index, obj){
                    data[obj.name] = obj.value;
                });

                // validation
                var username = $("#usernameId").val();
                var password = $("#passwordId").val();


                if (username && password != "") {
                    alert(JSON.stringify(data));
                    $.ajax({
                        url: window.origin+'/api/auth/signin',
                        type: 'POST',
                        data: JSON.stringify(data),
                        dataType: 'json',
                        contentType : "application/json",
                        success: function (response) {
                            console.log(response);
                            localStorage.setItem("token", JSON.stringify(response));
                        },
                        error : function(jqXHR, textStatus, errorThrown){
                            console.log(jqXHR);
                        }

                    });
                }
            });
        });
    </script>

</head>

<body class="bg-silver-300">
    <div class="content">
        <div class="brand">
            <a class="link" href="#">APPS IMMOBILIERE</a>
        </div>
        <div>
            <div class="text-center m-b-20">
                <img class="img-circle" src="/html/dist/assets/img/users/house.jpg" width="150px" />
            </div>
            <form class="text-center" id="sign_inForm" >
                <h5 class="font-strong">MANEROW DEV@</h5>
                <p class="font-13"></p>
                <div class="form-group">
                    <input class="form-control" type="text" id="usernameId" name="username" placeholder="nom utilisateur">
                </div>
                <div class="form-group">
                    <input class="form-control" type="password" id="passwordId" name="password" placeholder="******">
                </div>
                <div class="form-group">
                    <button class="btn btn-success btn-block" id="btnLoginId"><i class="fa fa-unlock-alt m-r-5"></i>Connexion</button>
                </div>
            </form>
        </div>
    </div>
    <style>
        .brand {
            font-size: 44px;
            text-align: center;
            margin: 40px 0;
        }

        .content {
            max-width: 300px;
            margin: 0 auto;
        }
    </style>
    <!-- BEGIN PAGA BACKDROPS-->
    <div class="sidenav-backdrop backdrop"></div>
    <div class="preloader-backdrop">
        <div class="page-preloader">Loading</div>
    </div>
    <!-- END PAGA BACKDROPS-->
    </body>

</html>